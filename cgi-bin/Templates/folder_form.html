<TMPL_INCLUDE menu-1.html>

	<TMPL_INCLUDE top_menu.html>

		<form method="POST" enctype="multipart/form-data" id="fld_form">
			<input type="hidden" name="op" value="fld_edit">
			<input type="hidden" name="fld_id" value="<TMPL_VAR fld_id>">
			<input type="hidden" name="fld_descr" id="fld-descr">

			<header class="border-b border-white/5">
				<div class="flex overflow-x-auto py-4 max-w-7xl">
					<div class="flex min-w-full flex-none justify-between gap-x-6 px-4 sm:px-6 lg:px-8">
						<a href="<TMPL_VAR site_url>/album/<TMPL_VAR fld_url>" target="_blank"
							class="text-md font-semibold leading-6 text-indigo-400 hover:text-indigo-300 flex items-center">
							<TMPL_VAR fld_name>
						</a>
						<button type="submit" name="save" value="<TMPL_VAR lng_misc_save>"
							class="inline-flex items-center justify-center rounded-md px-3 py-2 text-xs font-semibold text-green-400 bg-green-400/10 hover:bg-green-400/20">Save
							Details</button>
					</div>
				</div>
			</header>

			<div class="grid grid-cols-1 md:grid-cols-12 gap-x-8 gap-y-10 px-4 py-6 sm:px-6 lg:px-8 max-w-7xl">
				<div class="col-span-1 md:col-span-4">
					<div class="relative flex-shrink-0">
						<TMPL_IF fld_cover>
							<img class="rounded-md object-cover h-full w-full"
								src="<TMPL_VAR site_url>/upload-data/<TMPL_VAR fld_cover>" alt="<TMPL_VAR fld_name>">
							<TMPL_ELSE>
								<img class="rounded-md object-cover h-full w-full"
									src="<TMPL_VAR site_url>/images/no-album-cover.png" alt="<TMPL_VAR fld_name>">
						</TMPL_IF>

						<label for="fld_cover" class="cursor-pointer">
							<div
								class="absolute top-0 right-0 bg-gray-800 bg-opacity-70 hover:bg-gray-700 hover:bg-opacity-70 text-white font-bold py-2 px-4 rounded-full mt-3 mr-3 text-xs z-10">
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
									stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-white">
									<path stroke-linecap="round" stroke-linejoin="round"
										d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.774 48.774 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z">
									</path>
									<path stroke-linecap="round" stroke-linejoin="round"
										d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z">
									</path>
								</svg>
							</div>
						</label>
						<input type="file" name="fld_cover" id="fld_cover" accept="image/*" style="display: none;">
						<span class="absolute inset-0 rounded-md shadow-inner" aria-hidden="true"></span>

						<TMPL_IF fld_cover>
							<div
								class="absolute top-0 left-0 bg-gray-800 bg-opacity-70 hover:bg-gray-700 hover:bg-opacity-70 text-white font-bold py-2 px-4 rounded-full mt-3 ml-3 text-xs z-10">
								<a href="?op=fld_edit&fld_id=<TMPL_VAR fld_id>&cover_delete=1<TMPL_VAR token_str>"
									class="" onClick="return confirm('Delete cover?')">
									<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
										stroke-width="1.5" stroke="currentColor" class="text-white w-5 h-5">
										<path stroke-linecap="round" stroke-linejoin="round"
											d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
									</svg>
								</a>
							</div>
						</TMPL_IF>

					</div>
				</div>
				<div class="col-span-1 md:col-span-8">
					<div class="grid gap-x-6 gap-y-8">
						<div>
							<label for="fld_name" class="block text-sm font-medium leading-6 text-gray-300 mb-2">Album
								title</label>
							<input type="text" name="fld_name" value="<TMPL_VAR fld_name>"
								class="block w-full rounded-md border-0 bg-white/5 py-1.5 text-gray-400 shadow-sm focus:ring-2 focus:ring-inset focus:ring-indigo-500 sm:text-sm sm:leading-6">
						</div>
						<div>
							<label for="file_descr"
								class="block text-sm font-medium leading-6 text-gray-300 mb-2">Description</label>
							<div id="quill-editor" style="height: 200px;" class="text-gray-300">
								<TMPL_VAR fld_descr>
							</div>
						</div>
						<div>
							<div x-data="{ isChecked: <TMPL_IF fld_hide>true<TMPL_ELSE>false</TMPL_IF> }"
								class="inline-flex">
								<label for="fld_hide"
									class="flex items-center cursor-pointer select-none text-dark dark:text-white">
									<div class="relative">
										<input type="checkbox" name="fld_hide" value="1" id="fld_hide"
											x-model="isChecked" x-on:click="isChecked = !isChecked"
											class="peer sr-only" />
										<div class="block h-4 rounded-full box bg-gray-800 dark:bg-dark-2 w-8"
											x-bind:class="{ 'peer-checked:bg-indigo-400': isChecked }"></div>
										<div class="absolute flex items-center justify-center h-4 w-4 transition bg-white rounded-full dot left-0 top-0 dark:bg-dark-5"
											x-bind:class="{ 'peer-checked:translate-x-full peer-checked:dark:bg-white': isChecked }">
										</div>
									</div>
								</label>
								<label for="fld_hide" class="text-sm font-medium leading-6 text-white ml-5">Hide <span
										class="text-xs text-gray-400">(force hide from account account
										page)</span></label>
							</div>
						</div>
					</div>
				</div>
			</div>


		</form>

		<TMPL_IF msg>
			<div x-data="{ isOpen: true }" x-init="setTimeout(() => isOpen = false, 4000)" x-show="isOpen"
				x-transition:enter="transform ease-out duration-300 transition"
				x-transition:enter-start="translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2"
				x-transition:enter-end="translate-y-0 opacity-100 sm:translate-x-0"
				x-transition:leave="transition ease-in duration-100" x-transition:leave-start="opacity-100"
				x-transition:leave-end="opacity-0" aria-live="assertive"
				class="pointer-events-none fixed inset-0 z-50 flex items-end px-4 py-6 sm:items-start sm:p-6">
				<div class="flex w-full flex-col items-center space-y-4 sm:items-end">
					<div
						class="pointer-events-auto w-full max-w-sm overflow-hidden rounded-lg bg-gray-800 shadow-lg ring-1 ring-black ring-opacity-5">
						<div class="p-4">
							<div class="flex items-start">
								<div class="flex-shrink-0">
									<svg class="h-6 w-6 text-green-400" fill="none" viewBox="0 0 24 24"
										stroke-width="1.5" stroke="currentColor" aria-hidden="true">
										<path stroke-linecap="round" stroke-linejoin="round"
											d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
									</svg>
								</div>
								<div class="ml-3 w-0 flex-1 pt-0.5">
									<p class="text-sm font-medium text-gray-300">
										<TMPL_VAR msg>
									</p>
									<!-- <p class="mt-1 text-sm text-gray-500">Anyone with a link can now view this file.</p> -->
								</div>
								<div class="ml-4 flex flex-shrink-0">
									<button type="button"
										class="inline-flex rounded-md bg-gray-800 text-gray-400 hover:text-gray-500 focus:outline-none"
										x-on:click="isOpen = false">
										<span class="sr-only">Close</span>
										<svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
											<path
												d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" />
										</svg>
									</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</TMPL_IF>

		<script>
			var quill = new Quill('#quill-editor', {
				modules: {
					toolbar: [
						['bold', 'italic', 'underline'],
						[{ 'list': 'bullet' }],
						['image', 'link'],
						[{ 'direction': 'rtl' }],
						[{ 'header': [1, 2, 3, 4, 5, 6, false] }],
						[{ 'color': [] }],
						[{ 'align': [] }],
					]
				},
				theme: 'snow'
			});
			var toolbar = quill.getModule('toolbar');
			toolbar.addHandler('image', () => {
				var range = quill.getSelection();
				var value = prompt('Please enter the image URL');

				if (value) {
					quill.insertEmbed(range.index, 'image', value, 'user');
				}
			});

			toolbar.addHandler('link', () => {
				var range = quill.getSelection();
				if (range) {
					var value = prompt('Please enter the link URL');

					if (value) {
						quill.format('link', value);
					}
				}
			});

			function getQuillContent(quill) {
				var content = quill.root.innerHTML;
				// Check if content is empty (only contains blank paragraph)
				if (content === '<p><br></p>') {
					return '';
				} else {
					return content;
				}
			}
			document.querySelector('#fld_form').addEventListener('submit', function (e) {
				var quillContent = getQuillContent(quill);
				document.getElementById('fld-descr').value = quillContent;
			});

			quill.clipboard.addMatcher(Node.ELEMENT_NODE, (node, delta) => {
				let ops = [];
				delta.ops.forEach(op => {
					if (op.insert && typeof op.insert === 'string') {
						ops.push({
							insert: op.insert
						});
					}
				});
				delta.ops = ops;
				return delta;
			});

		</script>

		<script>
			$(document).ready(function () {
				$("body").addClass("h-full");
				$("html").addClass("h-full");
			});

			$(document).ready(function () {
				$('#fld_cover').on('change', function () {
					$('[name="save"]').click();
				});
			});

		</script>

		<TMPL_INCLUDE menu-2.html>